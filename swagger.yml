openapi: 3.0.3
info:
  version: '1'
  title: Ghdata
  description: ''
servers:
  - description: dev
    url: localhost
paths:

  /form-submit/psqi:
    post:
      summary: Submit PSQI Form
      tags:
        - form-submit
      requestBody:
        description: Psqi Submitted Form
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PsqiSubmittedFormInput'
      responses:
        '204':
          description: The resource was created successfuly.

  /form-submit/life-satisfaction:
    post:
      summary: Submit Life Satisfaction Form
      tags:
        - form-submit
      requestBody:
        description: Life Satisfaction Submitted Form
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LifeSatisfactionSubmittedFormInput'
      responses:
        '204':
          description: The resource was created successfuly.

  /garmin/sleeps:
    post:
      summary: Receive push notification from Garmin server with
      tags:
        - garmin-sleeps
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SleepPushSummary'
      responses:
        200:
          description: Sleep Push Notification Received

components:
  schemas:
    SubmittedFormInput:
      type: object
      properties:
        respondentIdentifier:
          type: string
          example: "Josef Cap"
          nullable: false
        researchNumber:
          type: string
          example: "pi2_2ei"
        answers:
          type: array
          items:
            $ref: '#/components/schemas/AnswerInput'

    PsqiSubmittedFormInput:
      allOf:
        - $ref: '#/components/schemas/SubmittedFormInput'
      properties:
        computationVariables:
          type: object
          properties:
            jestenevim:
              type: string

    LifeSatisfactionSubmittedFormInput:
      allOf:
        - $ref: '#/components/schemas/SubmittedFormInput'
      properties:
        computationVariables:
          type: object
          properties:
            zdr:
              $ref: '#/components/schemas/LifeSatisfactionComponentInputArray'
            prz:
              $ref: '#/components/schemas/LifeSatisfactionComponentInputArray'
            fin:
              $ref: '#/components/schemas/LifeSatisfactionComponentInputArray'
            vol:
              $ref: '#/components/schemas/LifeSatisfactionComponentInputArray'
            man:
              $ref: '#/components/schemas/LifeSatisfactionComponentInputArray'
            det:
              $ref: '#/components/schemas/LifeSatisfactionComponentInputArray'
            vlo:
              $ref: '#/components/schemas/LifeSatisfactionComponentInputArray'
            sex:
              $ref: '#/components/schemas/LifeSatisfactionComponentInputArray'
            pzp:
              $ref: '#/components/schemas/LifeSatisfactionComponentInputArray'
            byd:
              $ref: '#/components/schemas/LifeSatisfactionComponentInputArray'

    LifeSatisfactionComponentInputArray:
      type: array
      items:
        type: integer
      example: [ 1, 2, 2, 7, 3, 5, 3 ]
      minLength: 7
      maxLength: 7

    AnswerInput:
      type: object
      properties:
        value:
          type: string
          nullable: false
          example: "22:00"
        note:
          type: string
          nullable: true
          example: "Otazce uplne nerozumim"
        questionCode:
          type: string
          example: "lifesat_10"
          nullable: false

    SleepPushSummary:
      type: object
      properties:
        summaryId:
          type: string
          example: "eooa"
        calendarDate:
          type: string
          example: "2025-01-29"
        durationInSeconds:
          type: integer
          example: 28260
        startTimeInSeconds:
          type: integer
          example: 1611840660;
        startTimeOffsetInSeconds:
          type: integer
          example: 32400
        unmeasurableSleepInSeconds:
          type: integer
          example: 0
        deepSleepDurationInSeconds:
          type: integer
          example: 0
        lightSleepDurationInSeconds:
          type: integer
          example: 0
        remSleepInSeconds:
          type: integer
          example: 0
        awakeDurationInSeconds:
          type: integer
          example: 0
        validation:
          type: string
          enum:
            - "MANUAL"
            - "DEVICE"
            - "OFF_WRIST"
            - "AUTO_TENTATIVE"
            - "AUTO_FINAL"
            - "AUTO_MANUAL"
            - "ENHANCED_TENTATIVE"
            - "ENHANCED_FINAL"
          example: "ENHANCED_FINAL"
        timeOffsetSleepSpo2:
          type: object
          example: { }
        timeOffsetSleepRespiration:
          type: object
          example: { }
        userAccessToken:
          type: string
          example: "0da2a8c8-1da6-494d-b716-ebf4db0f0792"
